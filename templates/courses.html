{% extends "layout.html" %}

{% block title %}Cours{% endblock %}

{% block content %}
<div class="header-with-actions">
    <div>
        <h1>ğŸ“š Cours</h1>
        <p class="muted">{{ courses|length }} cours actif(s)</p>
    </div>
    <div class="action-group">
        {% if current_user.can_manage_courses() %}
        <a class="btn btn-primary" href="/add_course">â• Nouveau cours</a>
        {% endif %}
        <a class="btn btn-outline" href="/export_courses_csv">ğŸ“Š Exporter CSV</a>
    </div>
</div>

<div class="grid">
    {% for course in courses %}
    <div class="item">
        <div style="display:flex;flex-direction:column;gap:12px">
            <div>
                <h3 style="margin:0 0 4px 0">{{ course.name }}</h3>
                <p class="small muted" style="margin:0">{{ days_names[course.day_of_week] }} {{ course.start_time }} - {{ course.end_time }}</p>
                {% if course.level %}
                    <span class="badge badge-primary" style="margin-top:8px">{{ course.level }}</span>
                {% endif %}
                {% if course.max_archers %}
                    <p class="small muted" style="margin:8px 0 0 0">ğŸ‘¥ Max: {{ course.max_archers }} archers</p>
                {% endif %}
                {% if course.archers %}
                    <p class="small muted" style="margin:8px 0 0 0">
                        <strong>Inscrits:</strong> {{ course.archers|length }} archer(s)
                    </p>
                {% endif %}
                {% if course.notes %}
                    <p class="small muted" style="margin:8px 0 0 0">{{ course.notes }}</p>
                {% endif %}
            </div>
            <div style="padding-top:8px;border-top:1px solid var(--border-light);display:flex;flex-direction:column;gap:8px">
                {% if current_user.can_manage_courses() %}
                <a class="btn btn-outline" href="/course/{{ course.id }}/archers" style="width:100%">ğŸ‘¥ GÃ©rer les archers</a>
                <a class="btn btn-outline" href="/course/{{ course.id }}/attendance" style="width:100%">âœ“ PrÃ©sences</a>
                <a class="btn btn-outline" href="/edit_course/{{ course.id }}" style="width:100%">âœï¸ Modifier</a>
                <form method="POST" action="/delete_course/{{ course.id }}" onsubmit="return confirm('âš ï¸ ÃŠtes-vous sÃ»r de vouloir supprimer ce cours ?');">
                    <button type="submit" class="btn btn-danger" style="width:100%;cursor:pointer">ğŸ—‘ï¸ Supprimer</button>
                </form>
                {% elif current_user.can_manage_attendance() %}
                <a class="btn btn-outline" href="/course/{{ course.id }}/attendance" style="width:100%">âœ“ PrÃ©sences</a>
                {% endif %}
            </div>
        </div>
    </div>
    {% else %}
    <div class="card" style="grid-column:1/-1;text-align:center;padding:48px 24px">
        <p class="muted">Aucun cours enregistrÃ© pour le moment</p>
        {% if current_user.can_manage_courses() %}
        <a href="/add_course" class="btn btn-primary" style="margin-top:16px">â• Ajouter le premier cours</a>
        {% endif %}
    </div>
    {% endfor %}
</div>
{% endblock %}
